---
title: 为什么计算Hash运算时推荐选择对大质数取模？
date: 2024-11-01 18:49:20 +0800
categories: [算法]
tags: [aogorithm]     
---

# 为什么计算Hash运算时推荐选择对大质数取模？
先抛出结论：使用大质数作为模数，可以最大化地保证哈希值的均匀分布。

首先模数选择一个足够大的数很好理解，模数决定了取模结果的最大值，也即决定了取模结果的最大范围。范围越大对避免冲突越有利。

其次为什么要选择对一个质数取模。我们考虑取模之前的原始数据集合A={a1,....,an,...,ax,...,ay,...}。我们假设取一个合数H作为模数，理论上我们希望集合A对H进行取模后的结果均匀分布落在0-(H-1)之间。这里由于H是个合数那么理论上H将可能会和集合内的某些元素存在公约数，我们假设H和集合A中的an,ax,ay存在公约数k，那么可知an,ax和ay对H进行取模运算的结果只会落在0-(H/k-1)之间。如果集合A中大部分的数都是类似an,ax和ay这种情况那么就会导致集合A的大部分数的取模结果都落在了0-(H/k-1)这个更小的范围之内，也就导致了取模结果无法均匀分布（大部分的数映射到了更小的范围内）。极端情况下如果集合A内所有的数都和模数H存在公约数k那么最终取模的结果范围会是理论值(0-(H-1)之间)的k分之一。也就是说原始数据集合如果存在某种特殊的分布(规律)可能会导致对合数取模无法到达理想效果。注意这里说的只是可能，如果原始数据集是已知的或具有某种确定性以使得你能找到一个合数和你数据集中的绝大部分元素都不存在公约数那也行，只是不如无脑选择质数更方便。另外如果原始数据集合就是1.2.3.4...这种完全均匀分布的取质数还是合数也没有区别。

而如果我们选一个大质数Z作为模数。由于Z只能被1和他自身整除，因此除非集合A内存在大量的1和Z否则取模的结果将均匀分布在0-(Z-1)之间。而如果一个集合内存在大量重复值的情况，那么显然一开始就不应该在这个集合上进行hash运算。
